---

title: Data augmentation


keywords: fastai
sidebar: home_sidebar

summary: "Functions to augment the user's dataset with information from official sources."
description: "Functions to augment the user's dataset with information from official sources."
nb_path: "00_augmentation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_augmentation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h2><p>Most users will probably find it helpful to use the <code>DataAugment</code> transformer, which is compatible with <code>scikit-learn</code>, rather than the underlying functions. However, they are documented below in case their use might address some specific user need.</p>
<h2 id="Sources-of-data">Sources of data<a class="anchor-link" href="#Sources-of-data"> </a></h2><p><code>gingado</code> only lists official data sources by choice. This is meant to provide users with the trust that their dataset will be complemented by reliable sources. Unfortunately, it is not possible at this stage to include <em>all</em> official sources - let alone all reliable sources - because that requires substantial manual and maintenance work. <code>gingado</code> leverages the existence of the <a href="https://sdmx.org">Statistical Data and Metadata eXchange (SDMX)</a>, an organisation of official data sources that establishes common data and metadata formats, to download data that is relevant (and hopefully also useful) to users.</p>
<p>The function below from the package <a href="https://github.com/dkgaraujo/simpledmx">simpledmx</a> returns a list of codes corresponding to the data sources available to provide <code>gingado</code> users with data through SDMX.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">list_sdmx_sources</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;ABS&#39;,
 &#39;ABS_XML&#39;,
 &#39;BBK&#39;,
 &#39;BIS&#39;,
 &#39;CD2030&#39;,
 &#39;ECB&#39;,
 &#39;ESTAT&#39;,
 &#39;ILO&#39;,
 &#39;IMF&#39;,
 &#39;INEGI&#39;,
 &#39;INSEE&#39;,
 &#39;ISTAT&#39;,
 &#39;LSD&#39;,
 &#39;NB&#39;,
 &#39;NBB&#39;,
 &#39;OECD&#39;,
 &#39;SGR&#39;,
 &#39;SPC&#39;,
 &#39;STAT_EE&#39;,
 &#39;UNICEF&#39;,
 &#39;UNSD&#39;,
 &#39;WB&#39;,
 &#39;WB_WDI&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="augm_with_sdmx" class="doc_header"><code>augm_with_sdmx</code><a href="https://github.com/dkgaraujo/gingado/tree/main/gingado/augmentation.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>augm_with_sdmx</code>(<strong><code>df</code></strong>, <strong><code>freq</code></strong>, <strong><code>sources</code></strong>, <strong><code>variance_threshold</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Downloads relevant data from SDMX sources to complement the original dataset</p>
<p>Arguments:
  df: a pandas DataFrame
  freq: the frequency of the desired data from SDMX; for example, 'A' is annual
  sources: the list of SDMX sources or None; a list of possible sources can be obtained by running the function list_sdmx_sources()
  variance_threshold: a value larger than or equal to 0 or None, where 0 will lead to the removal of all data that does not vary across the dataset and None uses the scikit-learn default</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-gingado-to-jumpstart-a-dataset">Using <code>gingado</code> to jumpstart a dataset<a class="anchor-link" href="#Using-gingado-to-jumpstart-a-dataset"> </a></h2><p>Since <code>gingado</code> downloads data from official sources through SDMX, users may want to use this funcitonality to gather the dataset of interest instead of augmenting some previously existent data. In these cases, the argument <code>df</code> must be set to <code>None</code>, like so:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">augm_with_sdmx</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">time_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="s1">&#39;BIS&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|▌         | 1/18 [00:00&lt;00:04,  3.97it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_CBPOL_D ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|█         | 2/18 [00:00&lt;00:04,  3.91it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_CBPOL_M ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|█▋        | 3/18 [00:00&lt;00:04,  3.58it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_CBS_PUB ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|██▏       | 4/18 [00:01&lt;00:03,  3.92it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_CREDIT_GAP ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|██▊       | 5/18 [00:01&lt;00:03,  3.81it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_DEBT_SEC2_PUB ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|███▉      | 7/18 [00:01&lt;00:02,  4.10it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_DER_OTC_TOV ok!
Source: BIS, dataflow: WS_DSR ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 9/18 [00:02&lt;00:01,  4.57it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_EER_D ok!
Source: BIS, dataflow: WS_EER_M ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 56%|█████▌    | 10/18 [00:02&lt;00:01,  4.19it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_GLI ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 61%|██████    | 11/18 [00:02&lt;00:01,  3.91it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_LBS_D_PUB ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 67%|██████▋   | 12/18 [00:02&lt;00:01,  4.18it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_LONG_CPI ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 78%|███████▊  | 14/18 [00:03&lt;00:00,  4.32it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_OTC_DERIV2 ok!
Source: BIS, dataflow: WS_SPP ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 89%|████████▉ | 16/18 [00:03&lt;00:00,  4.88it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_TC ok!
Source: BIS, dataflow: WS_XRU ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 94%|█████████▍| 17/18 [00:03&lt;00:00,  5.23it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_XRU_D ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 18/18 [00:04&lt;00:00,  4.29it/s]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Source: BIS, dataflow: WS_XTD_DERIV ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|█▋        | 3/18 [00:00&lt;00:00, 21.58it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_CBPOL_D from BIS... not possible.
Trying to download WS_CBPOL_M from BIS... not possible.
Trying to download WS_CBS_PUB from BIS... not possible.
Trying to download WS_CREDIT_GAP from BIS... not possible.
Trying to download WS_DEBT_SEC2_PUB from BIS... not possible.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|███▎      | 6/18 [00:41&lt;01:38,  8.20s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_DER_OTC_TOV from BIS... ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 56%|█████▌    | 10/18 [00:42&lt;00:26,  3.35s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_DSR from BIS... not possible.
Trying to download WS_EER_D from BIS... not possible.
Trying to download WS_EER_M from BIS... not possible.
Trying to download WS_GLI from BIS... not possible.
Trying to download WS_LBS_D_PUB from BIS... not possible.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 67%|██████▋   | 12/18 [00:42&lt;00:13,  2.31s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_LONG_CPI from BIS... ok!
Trying to download WS_OTC_DERIV2 from BIS... not possible.
Trying to download WS_SPP from BIS... not possible.
Trying to download WS_TC from BIS... not possible.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 89%|████████▉ | 16/18 [00:42&lt;00:02,  1.25s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_XRU from BIS... ok!
Trying to download WS_XRU_D from BIS... not possible.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 18/18 [01:08&lt;00:00,  3.79s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Trying to download WS_XTD_DERIV from BIS... ok!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/4 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting data from BIS&#39;s WS_DER_OTC_TOV
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 75%|███████▌  | 3/4 [00:19&lt;00:05,  5.19s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Successful
Getting data from BIS&#39;s WS_LONG_CPI
Successful
Getting data from BIS&#39;s WS_XRU
Successful
Getting data from BIS&#39;s WS_XTD_DERIV
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 4/4 [00:20&lt;00:00,  5.02s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Successful
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BIS_WS_LONG_CPI_A_AE_628</th>
      <th>BIS_WS_LONG_CPI_A_AE_771</th>
      <th>BIS_WS_LONG_CPI_A_AR_628</th>
      <th>BIS_WS_LONG_CPI_A_AR_771</th>
      <th>BIS_WS_LONG_CPI_A_AT_628</th>
      <th>BIS_WS_LONG_CPI_A_AT_771</th>
      <th>BIS_WS_LONG_CPI_A_AU_628</th>
      <th>BIS_WS_LONG_CPI_A_AU_771</th>
      <th>BIS_WS_LONG_CPI_A_BE_628</th>
      <th>BIS_WS_LONG_CPI_A_BE_771</th>
      <th>...</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_MXN_8A</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8A</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8B</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8C</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8E</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8F</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8G</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_TO1_8K</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_USD_8A</th>
      <th>BIS_WS_XTD_DERIV_A_U_J_T_ZAR_8A</th>
    </tr>
    <tr>
      <th>TIME_PERIOD</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>116.781662</td>
      <td>3.070301</td>
      <td>416.975221</td>
      <td>34.150300</td>
      <td>116.259014</td>
      <td>2.004903</td>
      <td>117.898023</td>
      <td>1.911401</td>
      <td>115.451626</td>
      <td>2.053165</td>
      <td>...</td>
      <td>11.0</td>
      <td>846590.0</td>
      <td>471264.0</td>
      <td>284211.0</td>
      <td>90731.0</td>
      <td>59179.0</td>
      <td>31552.0</td>
      <td>383.0</td>
      <td>462350.0</td>
      <td>350.0</td>
    </tr>
    <tr>
      <th>2019-01-01</th>
      <td>114.524888</td>
      <td>-1.932473</td>
      <td>637.155776</td>
      <td>52.804230</td>
      <td>118.035180</td>
      <td>1.527766</td>
      <td>119.797086</td>
      <td>1.610768</td>
      <td>117.110457</td>
      <td>1.436820</td>
      <td>...</td>
      <td>7.0</td>
      <td>852979.0</td>
      <td>514054.0</td>
      <td>244999.0</td>
      <td>93613.0</td>
      <td>61141.0</td>
      <td>32472.0</td>
      <td>312.0</td>
      <td>503307.0</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>2020-01-01</th>
      <td>112.143786</td>
      <td>-2.079113</td>
      <td>895.091635</td>
      <td>40.482386</td>
      <td>119.741496</td>
      <td>1.445600</td>
      <td>120.811655</td>
      <td>0.846906</td>
      <td>117.978002</td>
      <td>0.740792</td>
      <td>...</td>
      <td>1.0</td>
      <td>774172.0</td>
      <td>446158.0</td>
      <td>238840.0</td>
      <td>88831.0</td>
      <td>58457.0</td>
      <td>30373.0</td>
      <td>343.0</td>
      <td>435049.0</td>
      <td>298.0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 658 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code above uses a greedy SDMX downloader that is not too concerned about selecting datasets in advance; rather, it downloads it data it possibly can from those official sources for the time period and frequency in question. It then filters out those data points that do not vary throughout the period, avoiding the use of memory to store data that does not contribute to the predictive power of the model. The dataset is then ready to be used.</p>
<p>Two things are important to highlight. First, choosing even one source (the <a href="www.bis.org">BIS</a> in this example) leads to the download of hundreds of variables. Some of them might be representing the same underlying concepts, but for different jurisdictions. The second thing to bear in mind is that download and in particular parsing of the SDMX data can take up some time depending on your local setting.</p>
<p>To use <code>gingado</code> to augment your dataset instead of creating a completely new one as done above, simply pass the original DataFrame as the argument <code>df</code> and name the corresponding column with the time values in the argument <code>time_col</code>.</p>

</div>
</div>
</div>
</div>
 


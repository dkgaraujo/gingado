---

title: Data augmentation


keywords: fastai
sidebar: home_sidebar

summary: "Functions to augment the user's dataset with information from official sources."
description: "Functions to augment the user's dataset with information from official sources."
nb_path: "00_augmentation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_augmentation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sources-of-data">Sources of data<a class="anchor-link" href="#Sources-of-data"> </a></h2><p><code>gingado</code> only lists official data sources by choice. This is meant to provide users with the trust that their dataset will be complemented by reliable sources. Unfortunately, it is not possible at this stage to include <em>all</em> official sources - let alone all reliable sources - because that requires substantial manual and maintenance work. <code>gingado</code> leverages the existence of the <a href="https://sdmx.org">Statistical Data and Metadata eXchange (SDMX)</a>, an organisation of official data sources that establishes common data and metadata formats, to download data that is relevant (and hopefully also useful) to users.</p>
<p>The function below from the package <a href="https://github.com/dkgaraujo/simpledmx">simpledmx</a> returns a list of codes corresponding to the data sources available to provide <code>gingado</code> users with data through SDMX.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">list_sdmx_sources</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;ABS&#39;,
 &#39;ABS_XML&#39;,
 &#39;BBK&#39;,
 &#39;BIS&#39;,
 &#39;CD2030&#39;,
 &#39;ECB&#39;,
 &#39;ESTAT&#39;,
 &#39;ILO&#39;,
 &#39;IMF&#39;,
 &#39;INEGI&#39;,
 &#39;INSEE&#39;,
 &#39;ISTAT&#39;,
 &#39;LSD&#39;,
 &#39;NB&#39;,
 &#39;NBB&#39;,
 &#39;OECD&#39;,
 &#39;SGR&#39;,
 &#39;SPC&#39;,
 &#39;STAT_EE&#39;,
 &#39;UNICEF&#39;,
 &#39;UNSD&#39;,
 &#39;WB&#39;,
 &#39;WB_WDI&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="augm_with_sdmx" class="doc_header"><code>augm_with_sdmx</code><a href="__main__.py#L4" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>augm_with_sdmx</code>(<strong><code>df</code></strong>, <strong><code>start_date</code></strong>, <strong><code>end_date</code></strong>, <strong><code>time_col</code></strong>, <strong><code>freq</code></strong>, <strong><code>sources</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Downloads relevant data from SDMX sources to complement the original dataset</p>
<p>Arguments:
  df: a pandas DataFrame
  start_date, end_date: the dates limiting the time period of the desired data from SDMX sources
  time_col: the name of the column in the original dataset that corresponds to time
  freq: the frequency of the desired data from SDMX; for example, 'A' is annual
  sources: the list of SDMX sources or None; a list of possible sources can be obtained by running the function list_sdmx_sources()</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-gingado-to-augment-a-dataset">Using <code>gingado</code> to augment a dataset<a class="anchor-link" href="#Using-gingado-to-augment-a-dataset"> </a></h2><p>The data augmentation functionalities of <code>gingado</code> is shown below using the <a href="https://www.macrohistory.net">Jordà-Schularick-Taylor Macrohistory Database</a> on macroeconomics and finance as an example. As a preliminary step, let's import <code>gingado</code> and other necessary libraries, and proceed to download the data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">JST_url</span> <span class="o">=</span> <span class="s2">&quot;http://data.macrohistory.net/JST/JSTdatasetR5.dta&quot;</span>
<span class="n">jst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">JST_url</span><span class="p">,</span> <span class="n">iterator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">jst</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>country</th>
      <th>iso</th>
      <th>ifs</th>
      <th>pop</th>
      <th>rgdpmad</th>
      <th>rgdppc</th>
      <th>rconpc</th>
      <th>gdp</th>
      <th>iy</th>
      <th>...</th>
      <th>eq_capgain</th>
      <th>eq_dp</th>
      <th>eq_capgain_interp</th>
      <th>eq_tr_interp</th>
      <th>eq_dp_interp</th>
      <th>bond_rate</th>
      <th>eq_div_rtn</th>
      <th>capital_tr</th>
      <th>risky_tr</th>
      <th>safe_tr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2659</th>
      <td>2013.0</td>
      <td>USA</td>
      <td>USA</td>
      <td>111</td>
      <td>315820.328999</td>
      <td>31571.993947</td>
      <td>103.425299</td>
      <td>101.892671</td>
      <td>16784.851</td>
      <td>0.192086</td>
      <td>...</td>
      <td>0.271035</td>
      <td>0.019355</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.023508</td>
      <td>0.024601</td>
      <td>0.139843</td>
      <td>0.212405</td>
      <td>-0.065168</td>
    </tr>
    <tr>
      <th>2660</th>
      <td>2014.0</td>
      <td>USA</td>
      <td>USA</td>
      <td>111</td>
      <td>318106.646578</td>
      <td>32113.618881</td>
      <td>105.186253</td>
      <td>104.113597</td>
      <td>17527.258</td>
      <td>0.196377</td>
      <td>...</td>
      <td>0.136350</td>
      <td>0.019199</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.025408</td>
      <td>0.021817</td>
      <td>0.130063</td>
      <td>0.132729</td>
      <td>0.122398</td>
    </tr>
    <tr>
      <th>2661</th>
      <td>2015.0</td>
      <td>USA</td>
      <td>USA</td>
      <td>111</td>
      <td>320413.930388</td>
      <td>32800.923063</td>
      <td>107.421590</td>
      <td>107.192931</td>
      <td>18224.780</td>
      <td>0.198301</td>
      <td>...</td>
      <td>-0.000092</td>
      <td>0.021124</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.021358</td>
      <td>0.021122</td>
      <td>0.046193</td>
      <td>0.065433</td>
      <td>-0.008779</td>
    </tr>
    <tr>
      <th>2662</th>
      <td>2016.0</td>
      <td>USA</td>
      <td>USA</td>
      <td>111</td>
      <td>322705.239927</td>
      <td>33078.508719</td>
      <td>108.318698</td>
      <td>109.333457</td>
      <td>18715.040</td>
      <td>0.195831</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2663</th>
      <td>2017.0</td>
      <td>USA</td>
      <td>USA</td>
      <td>111</td>
      <td>324802.861426</td>
      <td>33593.446309</td>
      <td>110.013284</td>
      <td>111.389150</td>
      <td>19519.424</td>
      <td>0.204547</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 57 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is organised in a panel data structure, so the 'year' and 'country' columns are used as indices of the DataFrame. The redundant columns 'iso' and 'ifs' (which are different ways to code the country name) and 'crisisJST_old', which is similar to the target variable 'crisisJST', are dropped.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">jst</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="s1">&#39;ifs&#39;</span><span class="p">,</span> <span class="s1">&#39;crisisJST_old&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">jst</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">jst</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

<span class="n">jst</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>pop</th>
      <th>rgdpmad</th>
      <th>rgdppc</th>
      <th>rconpc</th>
      <th>gdp</th>
      <th>iy</th>
      <th>cpi</th>
      <th>ca</th>
      <th>imports</th>
      <th>exports</th>
      <th>...</th>
      <th>eq_capgain</th>
      <th>eq_dp</th>
      <th>eq_capgain_interp</th>
      <th>eq_tr_interp</th>
      <th>eq_dp_interp</th>
      <th>bond_rate</th>
      <th>eq_div_rtn</th>
      <th>capital_tr</th>
      <th>risky_tr</th>
      <th>safe_tr</th>
    </tr>
    <tr>
      <th>year</th>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1870-01-01</th>
      <th>Australia</th>
      <td>1775.000000</td>
      <td>3273.239437</td>
      <td>13.836157</td>
      <td>21.449734</td>
      <td>208.780</td>
      <td>0.109266</td>
      <td>2.708333</td>
      <td>-6.147594</td>
      <td>36.000</td>
      <td>37.000</td>
      <td>...</td>
      <td>-0.070045</td>
      <td>0.071417</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.049118</td>
      <td>0.066415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1871-01-01</th>
      <th>Australia</th>
      <td>1675.000000</td>
      <td>3298.507463</td>
      <td>13.936864</td>
      <td>19.930801</td>
      <td>211.560</td>
      <td>0.104579</td>
      <td>2.666667</td>
      <td>5.260774</td>
      <td>34.000</td>
      <td>46.000</td>
      <td>...</td>
      <td>0.041654</td>
      <td>0.065466</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.048446</td>
      <td>0.068193</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1872-01-01</th>
      <th>Australia</th>
      <td>1722.000000</td>
      <td>3553.426249</td>
      <td>15.044247</td>
      <td>21.085006</td>
      <td>227.400</td>
      <td>0.130438</td>
      <td>2.541667</td>
      <td>7.867636</td>
      <td>38.000</td>
      <td>53.000</td>
      <td>...</td>
      <td>0.108945</td>
      <td>0.062997</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.047373</td>
      <td>0.069861</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1873-01-01</th>
      <th>Australia</th>
      <td>1769.000000</td>
      <td>3823.629169</td>
      <td>16.219443</td>
      <td>23.254910</td>
      <td>266.540</td>
      <td>0.124986</td>
      <td>2.541667</td>
      <td>-11.047833</td>
      <td>49.000</td>
      <td>50.000</td>
      <td>...</td>
      <td>0.083086</td>
      <td>0.064484</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.046720</td>
      <td>0.069842</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1874-01-01</th>
      <th>Australia</th>
      <td>1822.000000</td>
      <td>3834.796926</td>
      <td>16.268228</td>
      <td>23.458050</td>
      <td>287.580</td>
      <td>0.141960</td>
      <td>2.666667</td>
      <td>-5.563959</td>
      <td>49.000</td>
      <td>54.000</td>
      <td>...</td>
      <td>0.119389</td>
      <td>0.063503</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.046533</td>
      <td>0.071085</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2013-01-01</th>
      <th>USA</th>
      <td>315820.328999</td>
      <td>31571.993947</td>
      <td>103.425299</td>
      <td>101.892671</td>
      <td>16784.851</td>
      <td>0.192086</td>
      <td>173.067206</td>
      <td>-426.197000</td>
      <td>2768.600</td>
      <td>2276.625</td>
      <td>...</td>
      <td>0.271035</td>
      <td>0.019355</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.023508</td>
      <td>0.024601</td>
      <td>0.139843</td>
      <td>0.212405</td>
      <td>-0.065168</td>
    </tr>
    <tr>
      <th>2014-01-01</th>
      <th>USA</th>
      <td>318106.646578</td>
      <td>32113.618881</td>
      <td>105.186253</td>
      <td>104.113597</td>
      <td>17527.258</td>
      <td>0.196377</td>
      <td>175.997979</td>
      <td>-365.193000</td>
      <td>2879.284</td>
      <td>2371.027</td>
      <td>...</td>
      <td>0.136350</td>
      <td>0.019199</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.025408</td>
      <td>0.021817</td>
      <td>0.130063</td>
      <td>0.132729</td>
      <td>0.122398</td>
    </tr>
    <tr>
      <th>2015-01-01</th>
      <th>USA</th>
      <td>320413.930388</td>
      <td>32800.923063</td>
      <td>107.421590</td>
      <td>107.192931</td>
      <td>18224.780</td>
      <td>0.198301</td>
      <td>176.301162</td>
      <td>-407.769000</td>
      <td>2786.461</td>
      <td>2265.047</td>
      <td>...</td>
      <td>-0.000092</td>
      <td>0.021124</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.021358</td>
      <td>0.021122</td>
      <td>0.046193</td>
      <td>0.065433</td>
      <td>-0.008779</td>
    </tr>
    <tr>
      <th>2016-01-01</th>
      <th>USA</th>
      <td>322705.239927</td>
      <td>33078.508719</td>
      <td>108.318698</td>
      <td>109.333457</td>
      <td>18715.040</td>
      <td>0.195831</td>
      <td>178.575038</td>
      <td>-428.350000</td>
      <td>2738.146</td>
      <td>2217.576</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2017-01-01</th>
      <th>USA</th>
      <td>324802.861426</td>
      <td>33593.446309</td>
      <td>110.013284</td>
      <td>111.389150</td>
      <td>19519.424</td>
      <td>0.204547</td>
      <td>182.415361</td>
      <td>-439.642000</td>
      <td>2928.596</td>
      <td>2350.175</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2664 rows × 52 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

